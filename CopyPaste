import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import com.google.gson.*;

public class ISSDataFetcher {

    public static void main(String[] args) {
        String apiKey = "YOUR_API_KEY";
        int satId = 25544;  // ISS
        double observerLat = 40.5622;  // Example: South Jordan, UT
        double observerLng = -111.9297;
        int observerAlt = 1300; // in meters
        int seconds = 1;

        String urlStr = String.format(
            "https://api.n2yo.com/rest/v1/satellite/positions/%d/%.4f/%.4f/%d/%d&apiKey=%s",
            satId, observerLat, observerLng, observerAlt, seconds, apiKey);

        try {
            URL url = new URL(urlStr);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");

            BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));
            StringBuilder responseStr = new StringBuilder();
            String line;
            while ((line = reader.readLine()) != null) {
                responseStr.append(line);
            }
            reader.close();

            // Parse JSON using Gson
            JsonObject json = JsonParser.parseString(responseStr.toString()).getAsJsonObject();
            JsonObject position = json.getAsJsonArray("positions").get(0).getAsJsonObject();

            double latitude = position.get("satlatitude").getAsDouble();
            double longitude = position.get("satlongitude").getAsDouble();
            double altitude = position.get("sataltitude").getAsDouble();
            long timestamp = position.get("timestamp").getAsLong();

            System.out.println("üõ∞Ô∏è ISS Data:");
            System.out.println("Latitude: " + latitude);
            System.out.println("Longitude: " + longitude);
            System.out.println("Altitude (km): " + altitude);
            System.out.println("Timestamp (UTC): " + timestamp);

        } catch (Exception e) {
            System.out.println("Error fetching ISS data: " + e.getMessage());
        }
    }
}
